# üé≠ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–æ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (admin/user) –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:

- **–ê–¥–º–∏–Ω—ã** ‚Üí —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `admin-pages/`
- **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** ‚Üí —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `user-pages/`

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Windows Authentication:

**–ê–¥–º–∏–Ω—ã** (–≤–∏–¥—è—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `admin-pages`):
- `admin`
- `administrator`
- `root`
- `manager`
- `–∞–¥–º–∏–Ω`
- `–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä`
- `—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å`

**–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** (–≤–∏–¥—è—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `user-pages`):
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–æ–ª—É—á–∞—é—Ç —Ä–æ–ª—å `user` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
site/
‚îú‚îÄ‚îÄ admin-pages/          # –°—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ main-pg/
‚îÇ   ‚îú‚îÄ‚îÄ all-courses-pg/
‚îÇ   ‚îú‚îÄ‚îÄ questions-pg/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ user-pages/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ main-pg/
‚îÇ   ‚îú‚îÄ‚îÄ all-courses-pg/
‚îÇ   ‚îú‚îÄ‚îÄ questions-pg/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ templates/            # –û–±—â–∏–µ —à–∞–±–ª–æ–Ω—ã
    ‚îú‚îÄ‚îÄ base_static_page.html
    ‚îú‚îÄ‚îÄ css/
    ‚îî‚îÄ‚îÄ partials/
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

–ü—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∏—Å—Ç–µ–º–∞:
1. –ü–æ–ª—É—á–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Windows Authentication
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å (admin/user)
3. –í—ã–±–∏—Ä–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–∞–ø–∫—É —Å —à–∞–±–ª–æ–Ω–∞–º–∏
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–π —à–∞–±–ª–æ–Ω

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `backend/auth.py` –≤ –º–µ—Ç–æ–¥–µ `_determine_user_role()`:

```python
def _determine_user_role(self, username: str) -> str:
    admin_users = [
        'admin', 'administrator', 'root', 'manager',
        '–∞–¥–º–∏–Ω', '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', '—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å',
        '–≤–∞—à_–Ω–æ–≤—ã–π_–∞–¥–º–∏–Ω'  # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞
    ]
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ –º–µ—Ç–æ–¥–µ `_determine_user_role()` –¥–ª—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥—Ä—É–ø–ø Active Directory
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

```bash
cd site
python demo_role_system.py
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd site
python test_role_routing.py
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd site
python run.py
```

## üåê API

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

```http
GET /api/user
```

–û—Ç–≤–µ—Ç:
```json
{
  "username": "admin",
  "role": "admin",
  "full_name": "Admin",
  "domain": null,
  "ip_address": "127.0.0.1",
  "auth_method": "windows_auth"
}
```

### –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

```http
GET /debug/auth
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### URL –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ URL:
- `/main` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `/questions` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
- `/all-courses` - –≤—Å–µ –∫—É—Ä—Å—ã
- `/users-info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

–ù–æ –≤–∏–¥—è—Ç —Ä–∞–∑–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏:
- **–ê–¥–º–∏–Ω** –Ω–∞ `/main` –≤–∏–¥–∏—Ç –∞–¥–º–∏–Ω—Å–∫—É—é –≤–µ—Ä—Å–∏—é –∏–∑ `admin-pages/main-pg/`
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –Ω–∞ `/main` –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –≤–µ—Ä—Å–∏—é –∏–∑ `user-pages/main-pg/`

### –í —à–∞–±–ª–æ–Ω–∞—Ö

–í —à–∞–±–ª–æ–Ω–∞—Ö –¥–æ—Å—Ç—É–ø–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `{{ current_user.role }}` - —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (admin/user)
- `{{ username }}` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `{{ current_user.username }}` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Windows Authentication –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –†–æ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –í—Å–µ —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
- –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è directory traversal

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `backend/logs/app.log`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/debug/auth` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∏ `admin-pages` –∏ `user-pages` —Å—É—â–µ—Å—Ç–≤—É—é—Ç
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º —à–∞–±–ª–æ–Ω–æ–≤

## üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

‚úÖ **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü** - —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **Windows Authentication** - —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **API endpoints** - —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–π–¥–µ–Ω–æ  

üéâ **–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!**
